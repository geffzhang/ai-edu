Copyright © Microsoft Corporation. All rights reserved.
  适用于[License](https://github.com/Microsoft/ai-edu/blob/master/LICENSE.md)版权许可
  
# 知识点

- 多元线性回归
- 样本数据归一化

# 提出问题

大哥，北京的房价了解一下！

房价预测问题，成为了机器学习的一个入门话题。我们也不能免俗，但是，不要用美国的什么多少平方英尺，多少个房间的例子来说事儿了，中国人不能理解为啥多出来一个room还买得贵，羊毛不是出在羊身上吗？我们来个北京的例子！

影响北京房价的因素有很多，几个最重要的因子和它们的取值范围是：
- 朝向（在北方地区，窗户面向阳光的房子要抢手一些）：北=1，西=2，东=3，南=4
- 地理位置：二环，三环，四环，五环，六环，分别取值为2，3，4，5，6，二环的房子单价最贵
- 面积：40~120平米，连续值


影响房价的因素有很多，居住面积，地理位置，朝向，是其中三个比较重要的因素。当然还有学区房什么比较特殊的情况。关于房价，我们有1000个样本，每个样本有三个特征值，一个标签值，示例如下：

|样本序号|1|2|3|...|1000|
|---|---|----|---|--|--|
|朝向（东南西北）|2|2|3|...|3|
|地理位置（几环）|4|6|3|...|3|
|居住面积（平米）|79|116|109|...|98|
|整套价格（万元）|469|631|323|...|576|

- 特征值1 - 窗户朝向
一共有”东”“南”“西”“北“四个值，用数字化表示是：
东：3
南：4
西：2
北：1
因为朝南的房子比较贵，其次为东，西，北。为啥东比西贵？难度是因为我们常说“东西”，东在前，西在后？瞎扯！是因为夏天时朝西的窗户西晒时间长，比较热。

- 特征值2 - 地理位置
二环：2 - 单价最贵
三环：3
四环：4
五环：5
六环：6 - 单价最便宜

- 特征值3 - 房屋面积
统计所有样本数据得到房屋的面积范围是[40,120]


### 问题：在北京东五环的一套窗户朝西的93平米的房子，大概是多少钱？

由于表中可能没有恰好符合上述条件的数据，因此我们必须根据1000个样本值来建立一个模型，来解决我们的问题。

先假设这个问题是个线性回归问题，而且是典型的多元线性回归。函数模型如下：

$$y=a_0+a_1x_1+a_2x_2+\dots+a_kx_k$$

为了方便大家理解，咱们具体化一下上面的公式，按照本系列文章的符号约定就是：

$$ 
Z = w_1x_1+w_2x_2+w_3x_3+b = W*X + B
$$


# 下载训练数据

[点击下载训练数据](https://github.com/Microsoft/ai-edu/tree/master/B-%E6%95%99%E5%AD%A6%E6%A1%88%E4%BE%8B%E4%B8%8E%E5%AE%9E%E8%B7%B5/B6-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/Data/HousePriceXData.dat)

[点击下载标签数据](https://github.com/Microsoft/ai-edu/tree/master/B-%E6%95%99%E5%AD%A6%E6%A1%88%E4%BE%8B%E4%B8%8E%E5%AE%9E%E8%B7%B5/B6-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/Data/HousePriceYData.dat)

# 读取文件数据
```Python
import numpy as np
from pathlib import Path

def LoadData():
    Xfile = Path("HouseXData.dat")
    Yfile = Path("HouseYData.dat")
    if Xfile.exists() & Yfile.exists():
        XData = np.load(Xfile)
        YData = np.load(Yfile)
        return XData,YData
    
    return None,None
```


- [正规方程法](5.1-正规方程法.md)
- [神经网络法（梯度下降）](5.2-神经网络法.md)


正规方程与梯度下降对比：

||正规方程|梯度下降|
|---|-----|-----|
|方法|几次矩阵运算|多次迭代|
|特殊要求|$X^TX$的逆矩阵存在|需要确定学习率|
|复杂度|$O(n^3)$|$O(n^2)$|
|适用样本数|$m<10000$|$m>10000$|
